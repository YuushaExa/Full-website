<footer class="footer">
    <div class="container">
        <div class="columns has-text-centered">
            {{ range .Site.Menus.footer }}
                    <button id="CloudSave">Cloud Save</button>
<p id="lastsaveddata"></p>
            <div class="column is-narrow">
                <a href="{{ .URL }}" class="">{{ .Name }}</a>
            </div>
            {{ end }}
        </div>
    </div>
         <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
           <link href="/pagefind/pagefind-ui.css" rel="stylesheet">
        <script src="/pagefind/pagefind-ui.js" type="text/javascript"></script>
                 <script defer src="/js/color-thief.js"></script>
    <script src="https://unpkg.com/@popperjs/core@2"></script>
<script src="https://unpkg.com/tippy.js@6"></script>
     <script src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
              <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
            <script src="https://cdnjs.cloudflare.com/ajax/libs/lz-string/1.4.4/lz-string.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    
    
    <script defer>
$(document).ready(function() { 
  var scriptLoaded = false;

  $('#gallery img').click(function() {
    var clickedImage = $(this);

    if (!scriptLoaded) {
      var scriptElement = document.createElement('script');
      scriptElement.src = '/js/lightboxAI.js';
      scriptElement.onload = function() {
        clickedImage.trigger('click');
      };
      document.head.appendChild(scriptElement);
      scriptLoaded = true;
    }
  });
});
</script>
    
<link defer rel="stylesheet" href="/css/lightboxAI.css"/> 

    <script>
window.addEventListener('DOMContentLoaded', (event) => {

    pagefind = new PagefindUI({
        element: "#search",
        baseUrl: "/",
    });

    const urlParams = new URLSearchParams(window.location.search);
    const q = urlParams.get('q');
    if(q){
        setTimeout(function(){
            console.log('Searching:'+q);
            pagefind.triggerSearch(q);
        }, 1000);
    }

});
</script>

 <script>         
const lazyImages = document.querySelectorAll('[data-src]');

const options = {
  root: null,
  rootMargin: '0px 0px 300px 0px',
  threshold: 0.1 
};

const handleIntersection = (entries, observer) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      const lazyImage = entry.target;
      lazyImage.src = lazyImage.dataset.src;
      observer.unobserve(lazyImage); 
    }
  });
};

const observer = new IntersectionObserver(handleIntersection, options);

lazyImages.forEach(image => observer.observe(image));

      var storedTotalPosts = parseInt(localStorage.getItem('Games'));
  var currentTotalPosts = {{ len .Site.RegularPages }};
  if (storedTotalPosts !== currentTotalPosts) {
console.log('New games: ' + (currentTotalPosts - storedTotalPosts));
  localStorage.setItem('Games', currentTotalPosts);  
  }
</script> 
    <script defer src="/js/all.js"></script>
</footer>
