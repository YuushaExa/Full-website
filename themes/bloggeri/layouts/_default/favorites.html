{{ define "main" }}
<section class="section">
  <article>      
    <div class="container">
      <div class="post">
        <h1 data-pagefind-ignore class="post-title"><a href="{{ .Permalink }}">{{ .Title }}</a></h1>
  <div class="content">
    <span>Favorites: <p id="totalCount-fav"></p></span>
      <button id="sendDataButton">Send Data to GitHub</button>
    <div id="cardContainer"></div>   
     </div>
    </div>     </div>  
  </article>    
</section>
  <script>
    document.getElementById('sendDataButton').addEventListener('click', sendDataToGitHub);

    function sendDataToGitHub() {
      const localStorageData = JSON.stringify(localStorage); // Assuming local storage data is already in JSON format

      // GitHub repository information
      const owner = 'YuushaExa';
      const repo = 'web';
      const branch = 'master';
      const directory = 'dev/json/favfiles';
      const filename = 'data.json';

      const apiUrl = `https://api.github.com/repos/${owner}/${repo}/contents/${directory}/${filename}`;

      const token = {{< param "fav.key" >}};

      const fileContent = {
        message: 'Update data.json from local storage',
        content: btoa(localStorageData), // Encode the data as base64
      };

      fetch(apiUrl, {
        method: 'PUT',
        headers: {
          Authorization: `Bearer ${token}`,
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(fileContent),
      })
        .then(response => response.json())
        .then(data => {
          console.log('File created or updated successfully:', data);
        })
        .catch(error => {
          console.error('Error creating or updating the file:', error);
        });
    }
  </script>
<script>
window.onload = function() {
  displaySavedCards();
  attachToggleListeners();

var toggleButtons = document.querySelectorAll('.toggleButton path');
toggleButtons.forEach(function(button) {
  button.style.fill = 'unset';
});
var toggleButtons1 = document.querySelectorAll('.toggleButtonSVG');
toggleButtons1.forEach(function(button1) {
  button1.style.fill = 'rgb(4 252 14 / 80%)';
});
};
</script>
{{ end }}
